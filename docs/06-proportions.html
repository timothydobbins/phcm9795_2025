<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Summary statistics for binary data – PHCM9795: Foundations of Biostatistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07-testing-proportions.html" rel="next">
<link href="./05-comparing-two-means.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37e38b627515668d8a78bbca23c297a0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9a71a2450f5674972ff858c43d8deec0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #ffdc00;
      }
</style>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06-proportions.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summary statistics for binary data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summary statistics for binary data</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PHCM9795: Foundations of Biostatistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Summarising and presenting data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability and probability distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Precision, standard errors and confidence intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">An introduction to hypothesis testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-comparing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Comparing the means of two groups</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-proportions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summary statistics for binary data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-testing-proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis testing for categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-correlation-and-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-non-parametrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysing non-normal data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-sample-size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">An introduction to sample size estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  <li><a href="#optional-readings" id="toc-optional-readings" class="nav-link" data-scroll-target="#optional-readings">Optional readings</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">6.1</span> Introduction</a></li>
  <li><a href="#calculating-proportions-and-95-confidence-intervals" id="toc-calculating-proportions-and-95-confidence-intervals" class="nav-link" data-scroll-target="#calculating-proportions-and-95-confidence-intervals"><span class="header-section-number">6.2</span> Calculating proportions and 95% confidence intervals</a>
  <ul class="collapse">
  <li><a href="#calculating-a-proportion" id="toc-calculating-a-proportion" class="nav-link" data-scroll-target="#calculating-a-proportion"><span class="header-section-number">6.2.1</span> Calculating a proportion</a></li>
  <li><a href="#calculating-the-95-confidence-interval-of-a-proportion-wald-method" id="toc-calculating-the-95-confidence-interval-of-a-proportion-wald-method" class="nav-link" data-scroll-target="#calculating-the-95-confidence-interval-of-a-proportion-wald-method"><span class="header-section-number">6.2.2</span> Calculating the 95% confidence interval of a proportion (Wald method)</a></li>
  <li><a href="#worked-example-6.1" id="toc-worked-example-6.1" class="nav-link" data-scroll-target="#worked-example-6.1"><span class="header-section-number">6.2.3</span> Worked Example 6.1</a></li>
  <li><a href="#calculating-the-95-confidence-interval-of-a-proportion-wilson-method" id="toc-calculating-the-95-confidence-interval-of-a-proportion-wilson-method" class="nav-link" data-scroll-target="#calculating-the-95-confidence-interval-of-a-proportion-wilson-method"><span class="header-section-number">6.2.4</span> Calculating the 95% confidence interval of a proportion (Wilson method)</a></li>
  <li><a href="#wald-vs-wilson-methods" id="toc-wald-vs-wilson-methods" class="nav-link" data-scroll-target="#wald-vs-wilson-methods"><span class="header-section-number">6.2.5</span> Wald vs Wilson methods</a></li>
  </ul></li>
  <li><a href="#hypothesis-testing-for-one-sample-proportion" id="toc-hypothesis-testing-for-one-sample-proportion" class="nav-link" data-scroll-target="#hypothesis-testing-for-one-sample-proportion"><span class="header-section-number">6.3</span> Hypothesis testing for one sample proportion</a>
  <ul class="collapse">
  <li><a href="#z-test-for-testing-one-sample-proportion" id="toc-z-test-for-testing-one-sample-proportion" class="nav-link" data-scroll-target="#z-test-for-testing-one-sample-proportion"><span class="header-section-number">6.3.1</span> z-test for testing one sample proportion</a></li>
  <li><a href="#z-prop-example" id="toc-z-prop-example" class="nav-link" data-scroll-target="#z-prop-example"><span class="header-section-number">6.3.2</span> Worked Example 6.2</a></li>
  <li><a href="#binomial-test-for-testing-one-sample-proportion" id="toc-binomial-test-for-testing-one-sample-proportion" class="nav-link" data-scroll-target="#binomial-test-for-testing-one-sample-proportion"><span class="header-section-number">6.3.3</span> Binomial test for testing one sample proportion</a></li>
  <li><a href="#worked-example-6.3" id="toc-worked-example-6.3" class="nav-link" data-scroll-target="#worked-example-6.3"><span class="header-section-number">6.3.4</span> Worked example 6.3</a></li>
  </ul></li>
  <li><a href="#contingency-tables" id="toc-contingency-tables" class="nav-link" data-scroll-target="#contingency-tables"><span class="header-section-number">6.4</span> Contingency tables</a></li>
  <li><a href="#a-brief-summary-of-epidemiological-study-types" id="toc-a-brief-summary-of-epidemiological-study-types" class="nav-link" data-scroll-target="#a-brief-summary-of-epidemiological-study-types"><span class="header-section-number">6.5</span> A brief summary of epidemiological study types</a>
  <ul class="collapse">
  <li><a href="#randomised-controlled-trial" id="toc-randomised-controlled-trial" class="nav-link" data-scroll-target="#randomised-controlled-trial"><span class="header-section-number">6.5.1</span> Randomised controlled trial</a></li>
  <li><a href="#cohort-study" id="toc-cohort-study" class="nav-link" data-scroll-target="#cohort-study"><span class="header-section-number">6.5.2</span> Cohort study</a></li>
  <li><a href="#case-control-study" id="toc-case-control-study" class="nav-link" data-scroll-target="#case-control-study"><span class="header-section-number">6.5.3</span> Case control study</a></li>
  <li><a href="#cross-sectional-study" id="toc-cross-sectional-study" class="nav-link" data-scroll-target="#cross-sectional-study"><span class="header-section-number">6.5.4</span> Cross-sectional study</a></li>
  </ul></li>
  <li><a href="#measures-of-effect-for-epidemiological-studies" id="toc-measures-of-effect-for-epidemiological-studies" class="nav-link" data-scroll-target="#measures-of-effect-for-epidemiological-studies"><span class="header-section-number">6.6</span> Measures of effect for epidemiological studies</a>
  <ul class="collapse">
  <li><a href="#worked-example-6.4" id="toc-worked-example-6.4" class="nav-link" data-scroll-target="#worked-example-6.4"><span class="header-section-number">6.6.1</span> Worked Example 6.4</a></li>
  <li><a href="#worked-example-6.5" id="toc-worked-example-6.5" class="nav-link" data-scroll-target="#worked-example-6.5"><span class="header-section-number">6.6.2</span> Worked Example 6.5</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<p>By the end of this module you will be able to:</p>
<ul>
<li>Compute and interpret 95% confidence intervals for proportions;</li>
<li>Conduct and interpret a significance test for a one-sample proportion;</li>
<li>Use statistical software to compute 95% confidence intervals for a difference in proportions, a relative risk and an odds ratio.</li>
</ul>
</section>
<section id="optional-readings" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="optional-readings">Optional readings</h2>
<p><span class="citation" data-cites="kirkwood_sterne01">Kirkwood and Sterne (<a href="references.html#ref-kirkwood_sterne01" role="doc-biblioref">2001</a>)</span>; Chapter 16 <a href="http://er1.library.unsw.edu.au/er/cgi-bin/eraccess.cgi?url=https://ebookcentral.proquest.com/lib/unsw/detail.action?docID=624728">[UNSW Library Link]</a></p>
<p><span class="citation" data-cites="bland15">Bland (<a href="references.html#ref-bland15" role="doc-biblioref">2015</a>)</span>; Section 8.6, Section 13.7 <a href="http://er1.library.unsw.edu.au/er/cgi-bin/eraccess.cgi?url=https://ebookcentral.proquest.com/lib/unsw/detail.action?docID=5891730">[UNSW Library Link]</a></p>
<p><span class="citation" data-cites="acock10">Acock (<a href="references.html#ref-acock10" role="doc-biblioref">2010</a>)</span>; Section 7.5.</p>
</section>
<section id="introduction" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">6.1</span> Introduction</h2>
<p>In Modules 4 and 5, we discussed methods used to test hypotheses when the data are continuous. In Modules 6 and 7, we will focus on hypothesis testing for binary categorical data.</p>
<p>In health research, we often collect information that can be put into two categories, e.g.&nbsp;male and female, disease present or disease absent etc. Binary categorical variables such as these are summarised using proportions.</p>
</section>
<section id="calculating-proportions-and-95-confidence-intervals" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="calculating-proportions-and-95-confidence-intervals"><span class="header-section-number">6.2</span> Calculating proportions and 95% confidence intervals</h2>
<section id="calculating-a-proportion" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="calculating-a-proportion"><span class="header-section-number">6.2.1</span> Calculating a proportion</h3>
<p>We need two pieces of information to calculate a proportion: <span class="math inline">\(n\)</span>, the number of trials, and <span class="math inline">\(k\)</span>, the number of ‘successes’. Note that we use the term ‘success’ to describe the outcome of interest, recognising that a success may be a adverse outcome such as death or disease.</p>
<p>The following formula is used to calculate the proportion, <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[ p = k / n \]</span></p>
<p>The proportion, <span class="math inline">\(p\)</span>, is a number that lies between 0 and 1. Proportions and their confidence intervals can easily be converted to percentages by multiplying by 100 once computed.</p>
<p>As for all summary statistics, it is useful to compute the precision of the estimate as a 95% confidence interval (CI) to indicate the range of values in which are 95% confident that the true population value lies. In this module, we present two methods for computing a 95% confidence interval around a proportion.</p>
</section>
<section id="calculating-the-95-confidence-interval-of-a-proportion-wald-method" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="calculating-the-95-confidence-interval-of-a-proportion-wald-method"><span class="header-section-number">6.2.2</span> Calculating the 95% confidence interval of a proportion (Wald method)</h3>
<p>The Wald method for calculating the 95% confidence interval is based on assuming that the proportion, <span class="math inline">\(p\)</span>, is Normally distributed. This assumption is reasonable if the sample is sufficiently large (for example, if <span class="math inline">\(n&gt;30\)</span>) and if <span class="math inline">\(n \times (1-p)\)</span> and <span class="math inline">\(n \times p\)</span> are both larger than 5.</p>
<p>The Wald method for calculating a 95% confidence interval is given by:</p>
<p><span class="math display">\[\text{95\% CI} = p \pm (1.96 \times \text{SE}(p))\]</span></p>
<p>where the standard error of a proportion is computed as:</p>
<p><span class="math display">\[\text{SE}(p) = \sqrt{\frac{p \times (1 - p)}{n}}\]</span></p>
</section>
<section id="worked-example-6.1" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="worked-example-6.1"><span class="header-section-number">6.2.3</span> Worked Example 6.1</h3>
<p>In a cross-sectional study of children living in a rural village, 47 children from a random sample of 215 children were found to have scabies. Here <span class="math inline">\(n=215\)</span> and <span class="math inline">\(k=47\)</span>, so the proportion of children with scabies is estimated as:</p>
<p><span class="math display">\[ p = \frac{47}{215} = 0.2186 \]</span></p>
<p>Given the large sample size and the number of children with the rarer outcome is larger than 5, the Wald method is used to calculate the standard error of the proportion as:</p>
<p><span class="math display">\[{\text{SE}\left( p \right) = \sqrt{\frac{0.2186 \times (1 - 0.2186)}{215}}
}{= 0.02819}\]</span></p>
<p>Then, the 95% confidence interval is estimated as:</p>
<p><span class="math display">\[\text{95\% CI} = 0.2186 \pm 1.96 \times 0.02819\]</span></p>
<p><span class="math display">\[= 0.1634 \text{ to } 0.2739\]</span></p>
<p>The prevalence of scabies among children in the village is 21.9% (95% CI 16.3%, 27.4%). These values tell us that we are 95% confident that the true prevalence of scabies among children in the village is between 16.3% and 27.4%.</p>
</section>
<section id="calculating-the-95-confidence-interval-of-a-proportion-wilson-method" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="calculating-the-95-confidence-interval-of-a-proportion-wilson-method"><span class="header-section-number">6.2.4</span> Calculating the 95% confidence interval of a proportion (Wilson method)</h3>
<p>Another method to calculate the confidence interval of a proportion is the Wilson (sometimes also called the ‘score’) method. We can use it in situations where it is not appropriate to use the normal approximation to the binomial distribution as described above i.e.&nbsp;if the sample size is small (<span class="math inline">\(n &lt; 30\)</span>) or the number of subjects with the rarer outcome is 5 or fewer. This method much more difficult to implement by hand than the standard confidence interval, and so we will not discuss the hand calculation using the mathematical equation in this course. Instead, we use statistical software to do this (see the Stata or R notes for detail).</p>
<p>When using software, our worked example provides a 95% confidence interval of the prevalence of scabies of 16.9% to 27.9%.</p>
</section>
<section id="wald-vs-wilson-methods" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="wald-vs-wilson-methods"><span class="header-section-number">6.2.5</span> Wald vs Wilson methods</h3>
<p>The Wald method, which assumes that the underlying proportion follows a Normal distribution, is easy to calculate and follows the form of other confidence intervals. The Wilson method, which is difficult to calculate by hand, has nicer mathematical properties. There are also a number of other methods for calculating confidence intervals for proportions, but we do not discuss these in this course.</p>
<p>A paper by Brown, Cai and DasGupta (<span class="citation" data-cites="brown_etal01">Brown, Cai, and DasGupta (<a href="references.html#ref-brown_etal01" role="doc-biblioref">2001</a>)</span>) has compared the properties of the Wald and Wilson methods (among others) and concluded that the Wilson method is preferred over the Wald method. <strong>Therefore, we recommend the Wilson method be used to calculate 95% confidence intervals for a proportion.</strong></p>
</section>
</section>
<section id="hypothesis-testing-for-one-sample-proportion" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="hypothesis-testing-for-one-sample-proportion"><span class="header-section-number">6.3</span> Hypothesis testing for one sample proportion</h2>
<p>We can carry out a hypothesis test to compare a sample proportion to a hypothesised proportion. In much the same way as a one sample t-test was used in Module 5 to test a sample mean against a hypothesised mean, we can perform a one-sample test to test a sample proportion against a hypothesised proportion. The significance test will provide a P-value to assess the evidence against the null hypothesis, while the 95% confidence interval will provide the range in which we are 95% confident that the true proportion lies.</p>
<p>For example, we can test the following null hypothesis:</p>
<p>H<sub>0</sub>: sample proportion is not different from the hypothesised proportion</p>
<p>Much like constructing a 95% confidence interval, there are two main options when performing a hypothesis test on a single proportion: the first assumes that the proportion follows a Normal distribution, while the second relaxes this assumption.</p>
<section id="z-test-for-testing-one-sample-proportion" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="z-test-for-testing-one-sample-proportion"><span class="header-section-number">6.3.1</span> z-test for testing one sample proportion</h3>
<p>The first step in the z-test is to calculate a z-statistic, which is then used to calculate a P-value. The z-statistic is calculated as the difference between the population proportion and the sample proportion divided by the standard error of the population proportion, i.e.</p>
<p><span class="math display">\[
z = \frac{(p_{sample} - p_{population})}{\text{SE}(p_{population})}
\]</span></p>
<p>This z-statistic is then compared to the standard Normal distribution to calculate the P-value.</p>
</section>
<section id="z-prop-example" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="z-prop-example"><span class="header-section-number">6.3.2</span> Worked Example 6.2</h3>
<p>A national census in a country shows that 20% of the population are smokers. A survey of a community within the country that has received a public health anti-smoking intervention shows that 54 of 300 people sampled are smokers (18%). We can calculate a 95% confidence interval around this proportion using the Wilson method, which is calculated as 14.1% to 22.7%.</p>
<p>The researchers are interested in whether the proportion of smoking in this community is the same as the population prevalence of smoking of 20%. The null hypothesis can be written as: H<sub>0</sub>: the proportion of smokers in the community is 20% (the same as in the national census).</p>
<p>We can test this by calculating a z-statistic:</p>
<p><span class="math display">\[
\begin{aligned}
z &amp;= \frac{(0.18 - 0.20)}{\sqrt{\frac{0.20 × (1 - 0.20)}{300}}} \\
&amp;= -0.87
\end{aligned}
\]</span></p>
<p>The P-value for the test above can be obtained from a Normal distribution table as <span class="math inline">\(P = 2 × 0.192 = 0.38\)</span> (using Table A2.1 in the Appendix), or using the hand-calculator in Stata. This indicates that there is insufficient evidence to conclude that there is a difference between the proportion of smokers in the community and the country. This is consistent with our 95% confidence interval which crosses the null value of 20%.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod06/z-curve.png" class="img-fluid figure-img" style="width:66.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="binomial-test-for-testing-one-sample-proportion" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="binomial-test-for-testing-one-sample-proportion"><span class="header-section-number">6.3.3</span> Binomial test for testing one sample proportion</h3>
<p>We can use the binomial distribution to obtain an exact P-value for testing a single proportion. Historically, this was a time consuming process with much hand calculation. These days, statistical software performs the calculations quickly and efficiently, and is the preferred method.</p>
</section>
<section id="worked-example-6.3" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="worked-example-6.3"><span class="header-section-number">6.3.4</span> Worked example 6.3</h3>
<p>The file <code>mod06_smoking_status.csv</code> contains the data for this example. In the data file, smokers are coded as 1 and non-smokers are coded as 0.</p>
<p>In Stata, we can use the <code>prtest</code> command to perform a z-test, or the <code>bitest</code> command to perform the exact binomial test. In R, we can use the <code>prop.test</code> function to perform a z-test, or the <code>binom.test</code> function to perform the exact binomial test.</p>
<p>The z-test provides a two-sided P-value of 0.39, while the binomial test gives a two-sided P-value of 0.43. Both tests provide little evidence against the hypothesis that the prevalence of smoking in the community is 20%.</p>
</section>
</section>
<section id="contingency-tables" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="contingency-tables"><span class="header-section-number">6.4</span> Contingency tables</h2>
<p>As introduced in PHCM9794: Foundations of Epidemiology, 2-by-2 contingency tables can be used to examine associations between two binary variables, most commonly an exposure and an outcome. The traditional form of a 2-by-2 contigency table is given in <a href="#tbl-2-by-2-trad" class="quarto-xref">Table&nbsp;<span>6.1</span></a>.</p>
<div class="cell">
<div id="tbl-2-by-2-trad" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2-by-2-trad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.1: Traditional format for presenting a contingency table
</figcaption>
<div aria-describedby="tbl-2-by-2-trad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c85ebdac{}.cl-c85bc2b4{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c85d1100{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c85d1cfe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85d1cff{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85d1d00{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c85ebdac"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c85d1cfe"><p class="cl-c85d1100"><span class="cl-c85bc2b4"> </span></p></th><th class="cl-c85d1cfe"><p class="cl-c85d1100"><span class="cl-c85bc2b4">Outcome present</span></p></th><th class="cl-c85d1cfe"><p class="cl-c85d1100"><span class="cl-c85bc2b4">Outcome absent</span></p></th><th class="cl-c85d1cfe"><p class="cl-c85d1100"><span class="cl-c85bc2b4">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">Exposure present</span></p></td><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">a</span></p></td><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">b</span></p></td><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">a+b</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">Exposure absent</span></p></td><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">c</span></p></td><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">d</span></p></td><td class="cl-c85d1cff"><p class="cl-c85d1100"><span class="cl-c85bc2b4">c+d</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c85d1d00"><p class="cl-c85d1100"><span class="cl-c85bc2b4">Total</span></p></td><td class="cl-c85d1d00"><p class="cl-c85d1100"><span class="cl-c85bc2b4">a+c</span></p></td><td class="cl-c85d1d00"><p class="cl-c85d1100"><span class="cl-c85bc2b4">b+d</span></p></td><td class="cl-c85d1d00"><p class="cl-c85d1100"><span class="cl-c85bc2b4">N</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>When using a statistics program, it is recommended that the outcome and exposure variables are coded by assigning ‘absent’ as 0 and ‘present’ as 1, for example ‘No’ = 0 and ‘Yes’ = 1. This is needed for some of the commands to work (e.g.&nbsp;the epidemiology table commands). This coding ensures that measures of association, such as the odds ratio or relative risk, are computed correctly by Stata. While R does not require this coding to be followed, it is good practice nonetheless.</p>
</section>
<section id="a-brief-summary-of-epidemiological-study-types" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="a-brief-summary-of-epidemiological-study-types"><span class="header-section-number">6.5</span> A brief summary of epidemiological study types</h2>
<p>In this section, we wil present a very brief summary of three study types commonly used in population health research. This topic is covered in much more detail in <strong>PHCM9794: Foundations of Epidemiology</strong>, and more detail can be found in Chapter 4 of Essential Epidemiology (3rd or 4th edition) Webb, Bain and Page (<span class="citation" data-cites="webb_etal16">Webb, Bain, and Page (<a href="references.html#ref-webb_etal16" role="doc-biblioref">2016</a>)</span>).</p>
<section id="randomised-controlled-trial" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="randomised-controlled-trial"><span class="header-section-number">6.5.1</span> Randomised controlled trial</h3>
<p>A randomised controlled trial addresses the research question: what is the effect of an intervention on an outcome. In the simplest form of a randomised controlled trial, a group of participants is randomly allocated to a group that receives the treatment of interest or to a control group that does not receive the treatment of interest. Participants are followed up over time, and the outcome is measured at the conclusion of the study.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mod06/ee-rct.jpg" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption>The design of a randomised controlled trial [Figure 4.1, Essential Epidemiology]</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="cohort-study" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="cohort-study"><span class="header-section-number">6.5.2</span> Cohort study</h3>
<p>A cohort study is an <em>observational study</em> that addresses the research question: what is the effect of an exposure on an outcome. This research question is similar to that studied in a randomised controlled trial, but the exposure is defined by the participants’ circumstances, and not manipulated by the researchers. In a cohort study, participants without the outcome of interest are enrolled, followed over time, and information on their exposure to a factor is measured (either at baseline or over time). At the conclusion of the study, information on the outcome is measured to identify new (incident) cases.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mod06/ee-cohort.jpg" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption>The design of a cohort study [Figure 4.2, Essential Epidemiology]</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="case-control-study" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="case-control-study"><span class="header-section-number">6.5.3</span> Case control study</h3>
<p>While the randomised controlled trial and cohort study begin with a population without the outcome, a case-control study begins by assembling a group with the outcome of interest (cases), and a group without the outcome of interest (controls). The researchers then ask the cases and controls about their previous exposures.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mod06/ee-cc.jpg" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption>The design of a case-control trial [Figure 4.3, Essential Epidemiology]</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-sectional-study" class="level3" data-number="6.5.4">
<h3 data-number="6.5.4" class="anchored" data-anchor-id="cross-sectional-study"><span class="header-section-number">6.5.4</span> Cross-sectional study</h3>
<p>In a cross-sectional study, the exposure and the outcome are measured at the same time. While this results in a study that is relatively quick to conduct, it does not allow for any temporal relationships to be assessed.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mod06/ee-cs.jpg" class="img-fluid figure-img" style="width:66.0%"></p>
<figcaption>The design of a cross-sectional study [Figure 4.4, Essential Epidemiology]</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="measures-of-effect-for-epidemiological-studies" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="measures-of-effect-for-epidemiological-studies"><span class="header-section-number">6.6</span> Measures of effect for epidemiological studies</h2>
<p>We can calculate a <strong>relative</strong> measure of association between an exposure and an outcome as either a relative risk or odds ratio. The relative risk is a direct comparison of the risk in the exposed group with the risk in the non-exposed group, and can only be calculated for a cohort study (including a randomised controlled trial) or a cross-sectional study (where it is also called a <em>prevalence ratio</em>).</p>
<p>For cohort studies, randomised controlled trials and cross-section studies, we can calculate an <strong>absolute</strong> measure of association between an exposure and an outcome as a difference in proportions (also known as an <em>attributable risk</em>).</p>
<p>For case-control studies, as we sample participants based on their outcome, we can not estimate the risk of the outcome. Hence, calculating a relative risk or risk difference is inappropriate. Instead of calculating risks in a case-control study, we instead calculate <em>odds</em>, where the odds of an event are calculated as the number with the event divided by the number without the event.</p>
<div class="cell">
<div id="tbl-cc" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.2: Contingency table for a case-control study
</figcaption>
<div aria-describedby="tbl-cc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c87491fe{}.cl-c8720164{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c8731248{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c8731d74{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c8731d75{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c8731d76{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c87491fe"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c8731d74"><p class="cl-c8731248"><span class="cl-c8720164"> </span></p></th><th class="cl-c8731d74"><p class="cl-c8731248"><span class="cl-c8720164">Cases</span></p></th><th class="cl-c8731d74"><p class="cl-c8731248"><span class="cl-c8720164">Controls</span></p></th><th class="cl-c8731d74"><p class="cl-c8731248"><span class="cl-c8720164">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">Exposure present</span></p></td><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">a</span></p></td><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">b</span></p></td><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">a+b</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">Exposure absent</span></p></td><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">c</span></p></td><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">d</span></p></td><td class="cl-c8731d75"><p class="cl-c8731248"><span class="cl-c8720164">c+d</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c8731d76"><p class="cl-c8731248"><span class="cl-c8720164">Total</span></p></td><td class="cl-c8731d76"><p class="cl-c8731248"><span class="cl-c8720164">a+c</span></p></td><td class="cl-c8731d76"><p class="cl-c8731248"><span class="cl-c8720164">b+d</span></p></td><td class="cl-c8731d76"><p class="cl-c8731248"><span class="cl-c8720164">N</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>In the example in Table <a href="#tbl-cc" class="quarto-xref">Table&nbsp;<span>6.2</span></a>, we can calculate the odds of being exposed in the cases as <span class="math inline">\(a \div c\)</span>. Similarly, we can calculate the odds of being exposed in the controls as <span class="math inline">\(b \div d\)</span>. We can the calculate the <em>odds ratio</em> as:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Odds ratio} &amp;= (a \div c) \div (b \div d) \\
&amp;= \frac{a \times d}{b \times c} \\
&amp;= \frac{ad}{bc}
\end{aligned}
\]</span></p>
<p>Note that some authors say we should think of the odds ratio being based on the odds of being a case in the exposed group compared to the odds of being a case in the unexposed group. Here, the exposed group comprises cells “a” and “b”, so the odds of being a case in the exposed group is (a/b). Similarly, for the unexposed group, the odds of being exposed is (c/d). So our odds ratio becomes (a/b) / (c/d). If we rearrange this, we get the same odds ratio as above: (ad)/(bc).</p>
<p>The interpretation of an odds ratio is discussed in detail in PHCM9794: Foundations of Epidemiology, and an excerpt is presented here: The meaning of the calculated odds ratio as a measure of association between exposure and outcome is the same as for the rate ratio (relative risk) where:</p>
<ul>
<li>An odds ratio &gt;1 indicates that exposure is positively associated with disease (i.e.&nbsp;the exposure may be a cause of disease);</li>
<li>An odds ratio &lt; 1 indicates that exposure is negatively associated with disease (i.e.&nbsp;the exposure may be protective against disease); and</li>
<li>An odds ratio = 1 indicates no association between the exposure and the outcome.</li>
</ul>
<p>In some situations, related to how well controls are recruited into this study, the odds ratio is a close approximation of the relative risk. Therefore, you may see in some published papers of case control studies the OR interpreted as you would interpret a RR. This should be avoided in this course.</p>
<p>More information about the problems of interpreting odds-ratios as relative risks has been presented by <span class="citation" data-cites="deeks98">Deeks (<a href="references.html#ref-deeks98" role="doc-biblioref">1998</a>)</span> and <span class="citation" data-cites="schmidt_kohlmann08">Schmidt and Kohlmann (<a href="references.html#ref-schmidt_kohlmann08" role="doc-biblioref">2008</a>)</span>.</p>
<section id="worked-example-6.4" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="worked-example-6.4"><span class="header-section-number">6.6.1</span> Worked Example 6.4</h3>
<p>A randomised controlled trial was conducted among a group of patients to estimate the side effects of a drug. Fifty patients were randomly allocated to receive the active drug and 50 patients were allocated to receive a placebo drug. The outcome measured was the experience of nausea. The data is given in the files <code>mod06_nausea.dta</code> and <code>mod06_nausea.rds</code>.</p>
<p>A summary table can be constructed as in <a href="#tbl-rr-example" class="quarto-xref">Table&nbsp;<span>6.3</span></a>.</p>
<div class="cell">
<div id="tbl-rr-example" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rr-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.3: Nausea status by drug exposure
</figcaption>
<div aria-describedby="tbl-rr-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c87dfb72{}.cl-c87b5bce{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c87c6ec4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c87c6ece{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c87c79e6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87c79f0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87c79f1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87c79f2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87c79fa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87c79fb{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c87dfb72"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c87c79e6"><p class="cl-c87c6ec4"><span class="cl-c87b5bce"> </span></p></th><th class="cl-c87c79f0"><p class="cl-c87c6ece"><span class="cl-c87b5bce">Nausea</span></p></th><th class="cl-c87c79f0"><p class="cl-c87c6ece"><span class="cl-c87b5bce">No nausea</span></p></th><th class="cl-c87c79f0"><p class="cl-c87c6ece"><span class="cl-c87b5bce">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c87c79f1"><p class="cl-c87c6ec4"><span class="cl-c87b5bce">Active drug</span></p></td><td class="cl-c87c79f2"><p class="cl-c87c6ece"><span class="cl-c87b5bce">15</span></p></td><td class="cl-c87c79f2"><p class="cl-c87c6ece"><span class="cl-c87b5bce">35</span></p></td><td class="cl-c87c79f2"><p class="cl-c87c6ece"><span class="cl-c87b5bce">50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c87c79f1"><p class="cl-c87c6ec4"><span class="cl-c87b5bce">Placebo</span></p></td><td class="cl-c87c79f2"><p class="cl-c87c6ece"><span class="cl-c87b5bce">4</span></p></td><td class="cl-c87c79f2"><p class="cl-c87c6ece"><span class="cl-c87b5bce">46</span></p></td><td class="cl-c87c79f2"><p class="cl-c87c6ece"><span class="cl-c87b5bce">50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c87c79fa"><p class="cl-c87c6ec4"><span class="cl-c87b5bce">Total</span></p></td><td class="cl-c87c79fb"><p class="cl-c87c6ece"><span class="cl-c87b5bce">19</span></p></td><td class="cl-c87c79fb"><p class="cl-c87c6ece"><span class="cl-c87b5bce">81</span></p></td><td class="cl-c87c79fb"><p class="cl-c87c6ece"><span class="cl-c87b5bce">100</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>We can use Stata or R to calculate the relative risk (RR=3.75) and its 95% confidence interval (1.34 to 10.51). This tells us that nausea is 3.75 times more likely to occur in the active drug group compared with the placebo group. Because this is a randomised controlled trial, the relative risk would be an appropriate measure of association.</p>
<p>We can confirm the estimated relative risk:</p>
<p><span class="math display">\[
\begin{aligned}
\text{RR} &amp;= \frac{a / (a+b)}{c / (c+d)} \\
  &amp;= \frac{15 / (15+35)}{4 / (4+46)} \\
  &amp;= \frac{0.3}{0.08} \\
  &amp;= 3.75
\end{aligned}
\]</span></p>
</section>
<section id="worked-example-6.5" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="worked-example-6.5"><span class="header-section-number">6.6.2</span> Worked Example 6.5</h3>
<p>A case-control study investigated the association between human papillomavirus and oropharyngeal cancer (D'Souza, et al.&nbsp;NEJM 2007), and the results appear in <a href="#tbl-6-nejm" class="quarto-xref">Table&nbsp;<span>6.4</span></a>.</p>
<div class="cell">
<div id="tbl-6-nejm" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-6-nejm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.4: Association between human papillomavirus and oropharyngeal cancer
</figcaption>
<div aria-describedby="tbl-6-nejm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c8853f2c{}.cl-c8829f38{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c883b95e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c883b968{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c883c480{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c883c481{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c883c482{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c883c48a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c883c48b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c883c48c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c8853f2c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c883c480"><p class="cl-c883b95e"><span class="cl-c8829f38"> </span></p></th><th class="cl-c883c481"><p class="cl-c883b968"><span class="cl-c8829f38">Cases</span></p></th><th class="cl-c883c481"><p class="cl-c883b968"><span class="cl-c8829f38">Controls</span></p></th><th class="cl-c883c481"><p class="cl-c883b968"><span class="cl-c8829f38">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c883c482"><p class="cl-c883b95e"><span class="cl-c8829f38">HPV Positive</span></p></td><td class="cl-c883c48a"><p class="cl-c883b968"><span class="cl-c8829f38">57</span></p></td><td class="cl-c883c48a"><p class="cl-c883b968"><span class="cl-c8829f38">14</span></p></td><td class="cl-c883c48a"><p class="cl-c883b968"><span class="cl-c8829f38">71</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c883c482"><p class="cl-c883b95e"><span class="cl-c8829f38">HPV Negative</span></p></td><td class="cl-c883c48a"><p class="cl-c883b968"><span class="cl-c8829f38">43</span></p></td><td class="cl-c883c48a"><p class="cl-c883b968"><span class="cl-c8829f38">186</span></p></td><td class="cl-c883c48a"><p class="cl-c883b968"><span class="cl-c8829f38">229</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c883c48b"><p class="cl-c883b95e"><span class="cl-c8829f38">Total</span></p></td><td class="cl-c883c48c"><p class="cl-c883b968"><span class="cl-c8829f38">100</span></p></td><td class="cl-c883c48c"><p class="cl-c883b968"><span class="cl-c8829f38">200</span></p></td><td class="cl-c883c48c"><p class="cl-c883b968"><span class="cl-c8829f38">300</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>The odds ratio is the odds of being HPV positive in cases (those with oropharyngeal cancer) compared to the odds of being HPV positive in the controls (those without oropharyngeal cancer):</p>
<p><span class="math display">\[
\begin{aligned}
\text{OR} &amp;= \frac{a / c}{b /d} \\
  &amp;= \frac{57 / 43}{14 / 186} \\
  &amp;= 17.6
\end{aligned}
\]</span></p>
<p>We can use Stata or R to estimate the odds ratio and its 95% confidence interval. We should use the Cornfield option in Stata to provide a better estimate of the 95% confidence interval. It appears that the <code>jmv</code> package in R does not use the Cornfield approximation to estimate the 95% confidence interval, but uses the Woolf method.</p>
<p>The odds ratio is estimated as 17.6, and its 95% confidence interval is estimated 9.0 to 34.3 (Cornfield, using Stata) or 9.0 to 34.5 (Woolf, using R).</p>
<p>The interpretation of the confidence intervals for both the relative risk and the odds ratio is the same as for the confidence intervals around other summary measures in that it shows the region in which we are 95% confident that the true population estimate lies.</p>
<!--  -->
<!-- # Stata notes {-} -->
<!-- {{< include 06.1-proportions-stata.qmd >}} -->
<!--  -->
<!-- # R notes {-} -->
<!-- {{< include 06.2-proportions-R.qmd >}} -->
<!--  -->
<!-- # Activities {-} -->
<!-- {{< include 06.3-proportions-activities.qmd >}} -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-acock10" class="csl-entry" role="listitem">
Acock, Alan C. 2010. <em>A <span>Gentle Introduction</span> to <span>Stata</span></em>. 3rd ed. College Station, Tex: Stata Press.
</div>
<div id="ref-bland15" class="csl-entry" role="listitem">
Bland, Martin. 2015. <em>An <span>Introduction</span> to <span>Medical Statistics</span></em>. 4th Edition. Oxford, New York: Oxford University Press.
</div>
<div id="ref-brown_etal01" class="csl-entry" role="listitem">
Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta. 2001. <span>“Interval <span>Estimation</span> for a <span>Binomial Proportion</span>.”</span> <em>Statistical Science</em> 16 (2): 101–17. <a href="https://www.jstor.org/stable/2676784">https://www.jstor.org/stable/2676784</a>.
</div>
<div id="ref-deeks98" class="csl-entry" role="listitem">
Deeks, Jon. 1998. <span>“When Can Odds Ratios Mislead?”</span> <em>BMJ</em> 317 (7166): 1155. <a href="https://doi.org/10.1136/bmj.317.7166.1155a">https://doi.org/10.1136/bmj.317.7166.1155a</a>.
</div>
<div id="ref-kirkwood_sterne01" class="csl-entry" role="listitem">
Kirkwood, Betty, and Jonathan Sterne. 2001. <em>Essentials of <span>Medical Statistics</span></em>. 2nd edition. Malden, Mass: Wiley-Blackwell.
</div>
<div id="ref-schmidt_kohlmann08" class="csl-entry" role="listitem">
Schmidt, Carsten Oliver, and Thomas Kohlmann. 2008. <span>“When to Use the Odds Ratio or the Relative Risk?”</span> <em>International Journal of Public Health</em> 53 (3): 165–67. <a href="https://doi.org/10.1007/s00038-008-7068-3">https://doi.org/10.1007/s00038-008-7068-3</a>.
</div>
<div id="ref-webb_etal16" class="csl-entry" role="listitem">
Webb, Penny, Chris Bain, and Andrew Page. 2016. <em>Essential <span>Epidemiology</span>: <span>An Introduction</span> for <span>Students</span> and <span>Health Professionals</span></em>. 3rd edition. Cambridge: Cambridge University Press.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05-comparing-two-means.html" class="pagination-link" aria-label="Comparing the means of two groups">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Comparing the means of two groups</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07-testing-proportions.html" class="pagination-link" aria-label="Hypothesis testing for categorical data">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis testing for categorical data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>