<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Correlation and simple linear regression – PHCM9795: Foundations of Biostatistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-non-parametrics.html" rel="next">
<link href="./07-testing-proportions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-29fdfc89ac7fc112ecf2c1fbf9d5ebfc.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9a71a2450f5674972ff858c43d8deec0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #ffdc00;
      }
</style>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-correlation-and-regression.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PHCM9795: Foundations of Biostatistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to biostatistics and data fundamentals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Categorical data, presentation guidelines and probability distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Continuous probability distributions, sampling and precision</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">An introduction to hypothesis testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-comparing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Comparing the means of two groups</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summary statistics for binary data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-testing-proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis testing for categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-correlation-and-regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-non-parametrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysing non-normal data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98.1-appendix1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  <li><a href="#optional-readings" id="toc-optional-readings" class="nav-link" data-scroll-target="#optional-readings">Optional readings</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">8.1</span> Introduction</a></li>
  <li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation"><span class="header-section-number">8.2</span> Notation</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">8.3</span> Correlation</a>
  <ul class="collapse">
  <li><a href="#worked-example" id="toc-worked-example" class="nav-link" data-scroll-target="#worked-example">Worked Example</a></li>
  <li><a href="#correlation-coefficients" id="toc-correlation-coefficients" class="nav-link" data-scroll-target="#correlation-coefficients">Correlation coefficients</a></li>
  </ul></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">8.4</span> Linear regression</a>
  <ul class="collapse">
  <li><a href="#regression-equations" id="toc-regression-equations" class="nav-link" data-scroll-target="#regression-equations">Regression equations</a></li>
  </ul></li>
  <li><a href="#regression-coefficients-estimation" id="toc-regression-coefficients-estimation" class="nav-link" data-scroll-target="#regression-coefficients-estimation"><span class="header-section-number">8.5</span> Regression coefficients: estimation</a></li>
  <li><a href="#regression-coefficients-inference" id="toc-regression-coefficients-inference" class="nav-link" data-scroll-target="#regression-coefficients-inference"><span class="header-section-number">8.6</span> Regression coefficients: inference</a>
  <ul class="collapse">
  <li><a href="#fit-of-a-linear-regression-model" id="toc-fit-of-a-linear-regression-model" class="nav-link" data-scroll-target="#fit-of-a-linear-regression-model">Fit of a linear regression model</a></li>
  </ul></li>
  <li><a href="#assumptions-for-linear-regression" id="toc-assumptions-for-linear-regression" class="nav-link" data-scroll-target="#assumptions-for-linear-regression"><span class="header-section-number">8.7</span> Assumptions for linear regression</a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression"><span class="header-section-number">8.8</span> Multiple linear regression</a></li>
  <li><a href="#jamovi-notes" id="toc-jamovi-notes" class="nav-link" data-scroll-target="#jamovi-notes">Jamovi notes</a>
  <ul class="collapse">
  <li><a href="#creating-a-scatter-plot" id="toc-creating-a-scatter-plot" class="nav-link" data-scroll-target="#creating-a-scatter-plot"><span class="header-section-number">8.9</span> Creating a scatter plot</a></li>
  <li><a href="#calculating-a-correlation-coefficient" id="toc-calculating-a-correlation-coefficient" class="nav-link" data-scroll-target="#calculating-a-correlation-coefficient"><span class="header-section-number">8.10</span> Calculating a correlation coefficient</a></li>
  <li><a href="#fitting-a-simple-linear-regression-model" id="toc-fitting-a-simple-linear-regression-model" class="nav-link" data-scroll-target="#fitting-a-simple-linear-regression-model"><span class="header-section-number">8.11</span> Fitting a simple linear regression model</a></li>
  <li><a href="#plotting-residuals-from-a-simple-linear-regression" id="toc-plotting-residuals-from-a-simple-linear-regression" class="nav-link" data-scroll-target="#plotting-residuals-from-a-simple-linear-regression"><span class="header-section-number">8.12</span> Plotting residuals from a simple linear regression</a></li>
  </ul></li>
  <li><a href="#r-notes" id="toc-r-notes" class="nav-link" data-scroll-target="#r-notes">R notes</a>
  <ul class="collapse">
  <li><a href="#creating-a-scatter-plot-1" id="toc-creating-a-scatter-plot-1" class="nav-link" data-scroll-target="#creating-a-scatter-plot-1"><span class="header-section-number">8.13</span> Creating a scatter plot</a></li>
  <li><a href="#calculating-a-correlation-coefficient-1" id="toc-calculating-a-correlation-coefficient-1" class="nav-link" data-scroll-target="#calculating-a-correlation-coefficient-1">Calculating a correlation coefficient</a></li>
  <li><a href="#fitting-a-simple-linear-regression-model-1" id="toc-fitting-a-simple-linear-regression-model-1" class="nav-link" data-scroll-target="#fitting-a-simple-linear-regression-model-1"><span class="header-section-number">8.14</span> Fitting a simple linear regression model</a></li>
  <li><a href="#plotting-residuals-from-a-simple-linear-regression-1" id="toc-plotting-residuals-from-a-simple-linear-regression-1" class="nav-link" data-scroll-target="#plotting-residuals-from-a-simple-linear-regression-1"><span class="header-section-number">8.15</span> Plotting residuals from a simple linear regression</a></li>
  </ul></li>
  <li><a href="#activities" id="toc-activities" class="nav-link" data-scroll-target="#activities">Activities</a>
  <ul class="collapse">
  <li><a href="#activity-8.1" id="toc-activity-8.1" class="nav-link" data-scroll-target="#activity-8.1">Activity 8.1</a></li>
  <li><a href="#activity-8.2" id="toc-activity-8.2" class="nav-link" data-scroll-target="#activity-8.2">Activity 8.2</a></li>
  <li><a href="#activity-8.3" id="toc-activity-8.3" class="nav-link" data-scroll-target="#activity-8.3">Activity 8.3</a></li>
  <li><a href="#activity-8.4" id="toc-activity-8.4" class="nav-link" data-scroll-target="#activity-8.4">Activity 8.4</a></li>
  <li><a href="#supplementary-activity-8.5" id="toc-supplementary-activity-8.5" class="nav-link" data-scroll-target="#supplementary-activity-8.5">Supplementary Activity 8.5</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<p>By the end of this module you will be able to:</p>
<ul>
<li>Explore the association between two continuous variables using a scatter plot;</li>
<li>Estimate and interpret correlation coefficients;</li>
<li>Estimate and interpret parameters from a simple linear regression;</li>
<li>Assess the assumptions of simple linear regression;</li>
<li>Test a hypothesis using regression coefficients.</li>
</ul>
</section>
<section id="optional-readings" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="optional-readings">Optional readings</h2>
<p><span class="citation" data-cites="kirkwood_sterne01">Kirkwood and Sterne (<a href="references.html#ref-kirkwood_sterne01" role="doc-biblioref">2001</a>)</span>; Chapter 10. <a href="http://er1.library.unsw.edu.au/er/cgi-bin/eraccess.cgi?url=https://ebookcentral.proquest.com/lib/unsw/detail.action?docID=624728">[UNSW Library Link]</a></p>
<p><span class="citation" data-cites="bland15">Bland (<a href="references.html#ref-bland15" role="doc-biblioref">2015</a>)</span>; Chapter 11. <a href="http://er1.library.unsw.edu.au/er/cgi-bin/eraccess.cgi?url=https://ebookcentral.proquest.com/lib/unsw/detail.action?docID=5891730">[UNSW Library Link]</a></p>
</section>
<section id="introduction" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">8.1</span> Introduction</h2>
<p>In Module 5, we saw how to test whether the means from two groups are equal - in other words, whether a continuous variable is related to a categorical variable. Sometimes we are interested in how closely two continuous variables are related. For example, we may want to know how closely blood cholesterol levels are related to dietary fat intake in adult men. To measure the strength of association between two continuously distributed variables, a correlation coefficient is used.</p>
<p>We may also want to predict a value of a continuous measurement from another continuous measurement. For example, we may want to know predict values of lung capacity from height in a community of adults. A regression model allows us to use one measurement to predict another measurement.</p>
<p>Although both correlation coefficients and regression models can be used to describe the degree of association between two continuous variables, the two methods provide different information. It is important to note that both methods summarise the strength of an association between variables, and do not imply a causal relationship.</p>
</section>
<section id="notation" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="notation"><span class="header-section-number">8.2</span> Notation</h2>
<p>In this module, we will be focussing on the association between two variables, denoted <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>There may be cases where it does not matter which variable is denoted <span class="math inline">\(x\)</span> and which is denoted <span class="math inline">\(y\)</span>, however this is rare. We are usually interested in whether one variable is associated with another. If we believe that a change in <span class="math inline">\(x\)</span> will lead to a change in <span class="math inline">\(y\)</span>, or that <span class="math inline">\(y\)</span> is influenced by <span class="math inline">\(x\)</span>, we define <span class="math inline">\(y\)</span> as the <em>outcome variable</em> and <span class="math inline">\(x\)</span> as the <em>explanatory variable</em>.</p>
</section>
<section id="correlation" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="correlation"><span class="header-section-number">8.3</span> Correlation</h2>
<p>We use correlation to measure the strength of a linear relationship between two variables. Before calculating a correlation coefficient, a scatter plot should first be obtained to give an understanding of the nature of the relationship between the two variables.</p>
<section id="worked-example" class="level3">
<h3 class="anchored" data-anchor-id="worked-example">Worked Example</h3>
<p>The file <code>mod08_lung_function.csv</code> has information about height and lung function collected from a random sample of 120 adults. Information was collected on height (cm) and lung function, which was measured as forced vital capacity (FVC), measured in litres. We can obtain a <em>scatter-plot</em> shown in <a href="#fig-scatter-plot" class="quarto-xref">Figure&nbsp;<span>8.1</span></a>, where the outcome variable (<span class="math inline">\(y\)</span>) is plotted on the vertical axis, and the explanatory variable (<span class="math inline">\(x\)</span>) is plotted on the horizontal axis.</p>
<p><a href="#fig-scatter-plot" class="quarto-xref">Figure&nbsp;<span>8.1</span></a> shows that as height increases, lung function also increases, which is as expected. One or two of the data points are separated from the rest of the data but are not so far away as to be considered outliers because they do not seem to stand out of other observations.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scatter-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/mod08/scatterpng.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: Association between height and lung function in 120 adults
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="correlation-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="correlation-coefficients">Correlation coefficients</h3>
<p>A correlation coefficient (r) describes how closely the variables are related, that is the strength of linear association between two continuous variables. The range of the coefficient is from +1 to −1 where +1 is a perfect positive association, 0 is no association and −1 is a perfect inverse association. In general, an absolute (disregarding the sign) r value below 0.3 indicates a weak association, 0.3 to &lt; 0.6 is fair association, 0.6 to &lt; 0.8 is a moderate association, and <span class="math inline">\(\ge\)</span> 0.8 indicates a strong association.</p>
<p>The correlation coefficient is positive when large values of one variable tend to occur with large values of the other, and small values of one variable (y) tend to occur with small values of the other (x) (<a href="#fig-scatter-plot-four" class="quarto-xref">Figure&nbsp;<span>8.2</span></a> (a and b)). For example, height and weight in healthy children or age and blood pressure.</p>
<p>The correlation coefficient is negative when large values of one variable tend to occur with small values of the other, and small values of one variable tend to occur with large values of the other (<a href="#fig-scatter-plot-four" class="quarto-xref">Figure&nbsp;<span>8.2</span></a> (c and d)). For example, percentage immunised against infectious diseases and under-five mortality rate.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scatter-plot-four" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-plot-four-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/mod08/scatterplot-four-plots.png" class="img-fluid figure-img" style="width:66.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-plot-four-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.2: Scatter plots demonstrating strong and weak, positive and negative associations
</figcaption>
</figure>
</div>
</div>
</div>
<p>It is possible to calculate a P-value associated with a correlation coefficient to test whether the correlation coefficient is different from zero. However, a correlation coefficient with a large P-value does not imply that there is no relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, because the correlation coefficient only tests for a linear association and there may be a non-linear relationship such as a curved or irregular relationship.</p>
<p>The assumptions for using a Pearson’s correlation coefficient are that:</p>
<ul>
<li>observations are independent;</li>
<li>both variables are continuous variables;</li>
<li>the relationship between the two variables is linear.</li>
</ul>
<p>There is a further assumption that the data follow a bivariate normal distribution. This assumes: <em>y</em> follows a normal distribution for given values of <em>x</em>; and <em>x</em> follows a normal distribution for given values of <em>y</em>. This is quite a technical assumption that we do not discuss further.</p>
<p>There are two types of correlation coefficients– the correct one to use is determined by the nature of the variables as shown in <a href="#tbl-mod08-correlation-coefficients" class="quarto-xref">Table&nbsp;<span>8.1</span></a>.</p>
<div class="cell">
<div id="tbl-mod08-correlation-coefficients" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mod08-correlation-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.1: Correlation coefficients and their application
</figcaption>
<div aria-describedby="tbl-mod08-correlation-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-dc5734b8{}.cl-dc53b928{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dc53b93c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dc552510{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dc553190{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc553191{width:4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc55319a{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc55319b{width:4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc55319c{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc55319d{width:4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-dc5734b8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-dc553190"><p class="cl-dc552510"><span class="cl-dc53b928">Correlation coefficient</span></p></th><th class="cl-dc553191"><p class="cl-dc552510"><span class="cl-dc53b928">Application</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-dc55319a"><p class="cl-dc552510"><span class="cl-dc53b928">Pearson’s</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">correlation</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">coefficient:</span><span class="cl-dc53b928"> </span><span class="cl-dc53b93c">r</span></p></td><td class="cl-dc55319b"><p class="cl-dc552510"><span class="cl-dc53b928">Both</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">variables</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">are</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">continuous</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">and</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">a</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">bivariate</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">normal</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">distribution</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">can</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">be</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">assumed</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-dc55319c"><p class="cl-dc552510"><span class="cl-dc53b928">Spearman’s</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">rank</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">correlation:</span><span class="cl-dc53b928"> </span><span class="cl-dc53b93c">ρ</span></p></td><td class="cl-dc55319d"><p class="cl-dc552510"><span class="cl-dc53b928">Bivariate</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">normality</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">cannot</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">be</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">assumed.</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">Also</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">useful</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">when</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">at</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">least</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">one</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">of</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">the</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">variables</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">is</span><span class="cl-dc53b928"> </span><span class="cl-dc53b928">ordinal</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Spearman’s <span class="math inline">\(\rho\)</span> is calculated using the ranks of the data, rather than the actual values of the data. We will see further examples of such methods in Module 9, when we consider non-parametric tests, which are often based on ranks.</p>
<p>Correlation coefficients are often presented in the form of a <em>correlation matrix</em> which can display the correlation between a number of variables in a single table (<a href="#tbl-corrmatrix" class="quarto-xref">Table&nbsp;<span>8.2</span></a>).</p>
<div id="tbl-corrmatrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-corrmatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.2: Correlation matrix for Height and FVC
</figcaption>
<div aria-describedby="tbl-corrmatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Height</td>
<td>FVC</td>
</tr>
<tr class="even">
<td>Height</td>
<td>1</td>
<td>0.70<br>
P &lt; 0.0001</td>
</tr>
<tr class="odd">
<td>FVC</td>
<td>0.70<br>
P &lt; 0.0001</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>This correlation matrix shows that the Pearson’s correlation coefficient between height and lung function is 0.70 with P&lt;0.0001 indicating very strong evidence of a linear association between height and FVC. A correlation matrix sometimes includes correlations between the same variable, indicated as a correlation coefficient of 1. For example, <span class="math inline">\(Height\)</span> is perfectly correlated with itself (i.e.&nbsp;has a correlation coefficient of 1). Similarly, <span class="math inline">\(FVC\)</span> is perfectly correlated with itself.</p>
<p>Correlation coefficients are rarely used as important statistics in their own right because they do not fully explain the relationship between the two variables and the range of the data has an important influence on the size of the coefficient. In addition, the statistical significance of the correlation coefficient is often over interpreted because a small correlation which is of no clinical importance can become statistically significant even with a relatively small sample size. For example, a poor correlation of 0.3 will be statistically significant if the sample size is large enough.</p>
</section>
</section>
<section id="linear-regression" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">8.4</span> Linear regression</h2>
<p>The nature of a relationship between two variables is more fully described using regression, where the relationship is described by a straight line.</p>
<p><a href="#fig-scatter-plot-line" class="quarto-xref">Figure&nbsp;<span>8.3</span></a> shows our lung data with a fitted regression line.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scatter-plot-line" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-plot-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/mod08/scatterplot-line-fvc-height.png" class="img-fluid figure-img" style="width:66.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-plot-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.3: Association between height and lung function in 120 adults
</figcaption>
</figure>
</div>
</div>
</div>
<p>The line through the plot is called the line of ‘best fit’ because the size of the deviations between the data points and the line is minimised in estimating the line.</p>
<section id="regression-equations" class="level3">
<h3 class="anchored" data-anchor-id="regression-equations">Regression equations</h3>
<p>The mathematical equation for the line explains the relationship between two variables: <span class="math inline">\(y\)</span>, the outcome variable, and <span class="math inline">\(x\)</span>, the explanatory variable. The equation of the regression line is as follows:</p>
<p><span class="math display">\[y = \beta_{0} + \beta_{1}x\]</span></p>
<p>This line is shown in <a href="#fig-regression-parameters" class="quarto-xref">Figure&nbsp;<span>8.4</span></a> using the notation shown in <a href="#tbl-regression-notation" class="quarto-xref">Table&nbsp;<span>8.3</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-regression-parameters" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-regression-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/mod08/regression-line-parameters.png" class="img-fluid figure-img" style="width:66.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regression-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.4: Coefficients of a linear regression equation
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-regression-notation" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-regression-notation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.3: Notation for linear regression equation
</figcaption>
<div aria-describedby="tbl-regression-notation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-dc9ab026{}.cl-dc97ae8a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dc97ae8b{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dc97ae94{font-family:'Helvetica';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3.3pt;}.cl-dc9926ca{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dc9931ba{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931c4{width:2.34in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931c5{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931c6{width:2.34in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931c7{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931ce{width:2.34in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931cf{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931d0{width:2.34in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931d1{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dc9931d2{width:2.34in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-dc9ab026"><thead><tr style="overflow-wrap:break-word;"><th class="cl-dc9931ba"><p class="cl-dc9926ca"><span class="cl-dc97ae8a">Symbol</span></p></th><th class="cl-dc9931c4"><p class="cl-dc9926ca"><span class="cl-dc97ae8a">Interpretation</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-dc9931c5"><p class="cl-dc9926ca"><span class="cl-dc97ae8b">y</span></p></td><td class="cl-dc9931c6"><p class="cl-dc9926ca"><span class="cl-dc97ae8a">The</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">outcome</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">variable</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-dc9931c7"><p class="cl-dc9926ca"><span class="cl-dc97ae8b">x</span></p></td><td class="cl-dc9931ce"><p class="cl-dc9926ca"><span class="cl-dc97ae8a">The</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">explanatory</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">variable</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-dc9931cf"><p class="cl-dc9926ca"><span class="cl-dc97ae8b">β</span><span class="cl-dc97ae94">0</span></p></td><td class="cl-dc9931d0"><p class="cl-dc9926ca"><span class="cl-dc97ae8a">Intercept</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">of</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">the</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">regression</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">line</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-dc9931d1"><p class="cl-dc9926ca"><span class="cl-dc97ae8b">β</span><span class="cl-dc97ae94">1</span></p></td><td class="cl-dc9931d2"><p class="cl-dc9926ca"><span class="cl-dc97ae8a">Slope</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">of</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">the</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">regression</span><span class="cl-dc97ae8a"> </span><span class="cl-dc97ae8a">line</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>The intercept is the point at which the regression line intersects with the y-axis when the value of <span class="math inline">\(x\)</span> is zero. In most cases, the intercept does not have a biologically meaningful interpretation as the explanatory variable cannot take a value of zero. In our working example, the intercept is not meaningful as it is not possible for an adult to have a height of 0cm.</p>
<p>The slope of the line is the predicted change in the outcome variable <span class="math inline">\(y\)</span> as the explanatory explanatory variable <span class="math inline">\(x\)</span> increases by 1 unit.</p>
<p>An important concept is that regression predicts an expected value of <span class="math inline">\(y\)</span> given an observed value of <span class="math inline">\(x\)</span>: any error around the explanatory variable is not taken into account.</p>
</section>
</section>
<section id="regression-coefficients-estimation" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="regression-coefficients-estimation"><span class="header-section-number">8.5</span> Regression coefficients: estimation</h2>
<p>The regression parameters <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> are true, unknown quantities (similar to <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>), which are estimated using statistical software using the <em>method of least squares</em>. This method estimates the intercept and the slope, and also their variability (i.e.&nbsp;standard errors). Software is always used to estimate the regression parameters from a set of data.</p>
<p>Using the method of least squares:</p>
<ul>
<li>the intercept is estimated as <span class="math inline">\(b_0\)</span>;</li>
<li>the slope is estimated as <span class="math inline">\(b_1\)</span>.</li>
</ul>
</section>
<section id="regression-coefficients-inference" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="regression-coefficients-inference"><span class="header-section-number">8.6</span> Regression coefficients: inference</h2>
<p>We can use the estimated regression coefficients and their variability to calculate 95% confidence intervals. Here, a t-value from a t-distribution with <span class="math inline">\(n - 2\)</span> degrees of freedom is used:</p>
<ul>
<li>95% confidence interval for intercept: <span class="math inline">\(b_0 \pm t_{n-2} \times SE(b_0)\)</span></li>
<li>95% confidence interval for slope: <span class="math inline">\(b_1 \pm t_{n-2} \times SE(b_1)\)</span></li>
</ul>
<p>Note that as the constant (<span class="math inline">\(b_0\)</span>) is not often biologically plausible, the 95% confidence interval for the constant is often not reported.</p>
<p>The significance of the estimated slope (and less commonly, intercept) can be tested using a t-test. The null hypotheses and the alternative hypothesis for testing the slope of a simple linear regression model are:</p>
<ul>
<li>H<sub>0</sub>: <span class="math inline">\(\beta_1 = 0\)</span></li>
<li>H<sub>1</sub>: <span class="math inline">\(\beta_1 \ne 0\)</span></li>
</ul>
<p>To test the null hypothesis for the regression coefficient <span class="math inline">\(\beta_1\)</span>, the following t-test is used:</p>
<p><span class="math display">\[t = b_1 /SE(b_1)\]</span></p>
<p>This will give a t statistic which can be referred to a t distribution with n − 2 degrees of freedom to calculate the corresponding P-value.</p>
<p><a href="#tbl-estimated-regression" class="quarto-xref">Table&nbsp;<span>8.4</span></a> shows the estimated regression coefficients for our working example.</p>
<div class="cell">
<div id="tbl-estimated-regression" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-estimated-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.4: Estimated regression coefficients
</figcaption>
<div aria-describedby="tbl-estimated-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-dca39ad8{}.cl-dca091a8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dca1a8b8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dca1a8b9{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dca1a8c2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dca1b448{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b449{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b452{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b453{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b454{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b455{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b45c{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b45d{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b45e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b45f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b460{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dca1b466{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-dca39ad8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-dca1b448"><p class="cl-dca1a8b8"><span class="cl-dca091a8">Term</span></p></th><th class="cl-dca1b449"><p class="cl-dca1a8b9"><span class="cl-dca091a8">Estimate</span></p></th><th class="cl-dca1b449"><p class="cl-dca1a8b9"><span class="cl-dca091a8">Standard error</span></p></th><th class="cl-dca1b452"><p class="cl-dca1a8c2"><span class="cl-dca091a8">t value</span></p></th><th class="cl-dca1b448"><p class="cl-dca1a8b8"><span class="cl-dca091a8">P value</span></p></th><th class="cl-dca1b453"><p class="cl-dca1a8c2"><span class="cl-dca091a8">95% Confidence interval</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-dca1b454"><p class="cl-dca1a8b8"><span class="cl-dca091a8">Intercept</span></p></td><td class="cl-dca1b455"><p class="cl-dca1a8b9"><span class="cl-dca091a8">-18.87</span></p></td><td class="cl-dca1b455"><p class="cl-dca1a8b9"><span class="cl-dca091a8">2.194</span></p></td><td class="cl-dca1b45c"><p class="cl-dca1a8c2"><span class="cl-dca091a8">t=-8.60, 118df</span></p></td><td class="cl-dca1b454"><p class="cl-dca1a8b8"><span class="cl-dca091a8">&lt;0.001</span></p></td><td class="cl-dca1b45d"><p class="cl-dca1a8c2"><span class="cl-dca091a8">-23.22 to -14.53</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-dca1b45e"><p class="cl-dca1a8b8"><span class="cl-dca091a8">Height</span></p></td><td class="cl-dca1b45f"><p class="cl-dca1a8b9"><span class="cl-dca091a8">0.14</span></p></td><td class="cl-dca1b45f"><p class="cl-dca1a8b9"><span class="cl-dca091a8">0.013</span></p></td><td class="cl-dca1b460"><p class="cl-dca1a8c2"><span class="cl-dca091a8">t=10.58, 118df</span></p></td><td class="cl-dca1b45e"><p class="cl-dca1a8b8"><span class="cl-dca091a8">&lt;0.001</span></p></td><td class="cl-dca1b466"><p class="cl-dca1a8c2"><span class="cl-dca091a8">0.11 to 0.17</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>From this output, we see that the slope is estimated as 0.14 with an estimated intercept of -18.87. Therefore, the regression equation is estimated as:</p>
<p>FVC (L) = − 18.87 + (0.14 <span class="math inline">\(\times\)</span> Height in cm)</p>
<p>There is very strong evidence of a linear association between FVC and height in cm (P &lt; 0.001).</p>
<p>This equation can be used to predict FVC for a person of a given height. For example, the predicted FVC for a person 165 cm tall is estimated as:</p>
<p>FVC = − 18.87347 + (0.1407567 <span class="math inline">\(\times\)</span> 165.0) = 4.40 L.</p>
<p>Note that for the purpose of prediction we have kept all the decimal places in the coefficients to avoid rounding error in the intermediate calculation.</p>
<section id="fit-of-a-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="fit-of-a-linear-regression-model">Fit of a linear regression model</h3>
<p>After fitting a linear regression model, it is important to know how well the model fits the observed data. One way of assessing the model fit is to compute a statistic called coefficient of determination, denoted by <span class="math inline">\(R^2\)</span>. It is the square of the Pearson correlation coefficient <span class="math inline">\(r: r^2 = R^2\)</span>. Since the range of <span class="math inline">\(r\)</span> is from −1 to 1, <span class="math inline">\(R^2\)</span> must lie between 0 and 1.</p>
<p><span class="math inline">\(R^2\)</span> can be interpreted as the proportion of variability in y that can be explained by variability in x. Hence, the following conditions may arise:</p>
<p>If <span class="math inline">\(R^2 = 1\)</span>, then all variation in y can be explained by variation of x and all data points fall on the regression line.</p>
<p>If <span class="math inline">\(R^2 = 0\)</span>, then none of the variation in y is related to x at all, and the variable x explains none of the variability in y.</p>
<p>If <span class="math inline">\(0 &lt; R^2 &lt;1\)</span>, then the variability of y can be partially explained by the variability in x. The larger the <span class="math inline">\(R^2\)</span> value, the better is the fit of the regression model.</p>
</section>
</section>
<section id="assumptions-for-linear-regression" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="assumptions-for-linear-regression"><span class="header-section-number">8.7</span> Assumptions for linear regression</h2>
<p>Regression is robust to moderate degrees of non-normality in the variables, provided that the sample size is large enough and that there are no influential outliers. Also, the regression equation describes the relationship between the variables and this is not influenced as much by the spread of the data as the correlation coefficient is.</p>
<p>The assumptions that must be met when using linear regression are as follows:</p>
<ul>
<li>observations are independent;</li>
<li>the relationship between the explanatory and the outcome variable is linear;</li>
<li>the residuals are normally distributed.</li>
</ul>
<p>A residual is defined as the difference between the observed and predicted outcome from the regression model. If the predicted value of the outcome variable is denoted by <span class="math inline">\(\hat y\)</span> then:</p>
<p><span class="math display">\[ \text{Residual} = \text{observed} - \text{predicted} = y - \hat y\]</span></p>
<p>It is important for regression modelling that the data are collected in a period when the relationship remains constant. For example, in building a model to predict normal values for lung function the data must be collected when the participants have been resting and not exercising and people taking bronchodilator medications that influence lung capacity should be excluded. In regression, it is not so important that the variables themselves are normally distributed, but it is important that the residuals are. Scatter plots and specific diagnostic tests can be used to check the regression assumptions. Some of these will not be covered in this introductory course but will be discussed in detail in the <strong>Regression Methods in Biostatistics</strong> course.</p>
<p>The distribution of the residuals should always be checked. Large residuals can indicate unusual points or points that may exert undue influence on the estimated regression slope.</p>
<p>The distribution of the residuals from the model is shown in <a href="#fig-residual-dist" class="quarto-xref">Figure&nbsp;<span>8.5</span></a>. The residuals are approximately normally distributed, with no outlying values.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-residual-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residual-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/mod08/regression-residual-dist.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residual-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.5: Distribution of regression residuals
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="multiple-linear-regression" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="multiple-linear-regression"><span class="header-section-number">8.8</span> Multiple linear regression</h2>
<p>In the above example, we have only used a simple linear regression model of two continuous variables. Other more complex models can be built from this e.g.&nbsp;if we wanted to look at the effect of gender (male vs.&nbsp;female) as binary indicator in the model while adjusting for the effect of height. In that case we would include both the variables in the model as explanatory variables. In the same way we can include any number of explanatory variables (both continuous and categorical) in the model: this is called a multivariable model. Multivariable models are often used for building predictive equations, for example by using age, height, gender and smoking history to predict lung function, or to adjust for confounding and detect effect modification to investigate the association between an exposure and an outcome factor.</p>
<p>Multiple regression has an important role in investigating causality in epidemiology. The exposure variable under investigation must stay in the model and the effects of other variables which can be confounders or effect-modifiers are tested. The biological, psychological or social meaning of the variables in the model and their interactions are of great importance for interpreting theories of causality.</p>
<p>Other multivariable models include binary logistic regression for use with a binary outcome variable, or Cox regression for survival analyses. These models, together with multiple regression, will be taught in <strong>PHCM9517: Regression Methods in Biostatistics</strong>.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="jamovi-notes" class="level1 unnumbered">
<h1 class="unnumbered">Jamovi notes</h1>
<section id="creating-a-scatter-plot" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="creating-a-scatter-plot"><span class="header-section-number">8.9</span> Creating a scatter plot</h2>
<p>We will demonstrate using Jamovi for correlation and simple linear regression using the dataset <code>mod08_lung_function.csv</code>.</p>
<p>To create a scatter plot to explore the association between height and FVC, we use <strong>Scatterplot</strong> within the <strong>Exploration</strong> menu:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod08/jamovi/twoway-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Choose <strong>Height</strong> for the <strong>X-Axis</strong>, and <strong>FVC</strong> for the <strong>Y-Axis</strong>, and the scatter-plot appears in the Output window:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod08/jamovi/twoway-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>To add a fitted line, click the <strong>Linear</strong> option in the <strong>Regression Line</strong> section:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod08/jamovi/twoway-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>To save your graph, right-click the graph and choose <strong>Image &gt; Export</strong>, and be sure to save your file as a PNG file:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod08/jamovi/twoway-7.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-a-correlation-coefficient" class="level2" data-number="8.10">
<h2 data-number="8.10" class="anchored" data-anchor-id="calculating-a-correlation-coefficient"><span class="header-section-number">8.10</span> Calculating a correlation coefficient</h2>
<p>To calculate the Pearson’s correlation using the dataset <code>mod08_lung_function.csv</code> choose: <strong>Correlation Matrix</strong> within the <strong>Regression</strong> menu.</p>
<p>Select the two variables, <strong>FVC</strong> and <strong>Height</strong> in the <strong>Variables</strong> box, and a correlation matrix will be constructed, similar to <a href="#tbl-corrmatrix" class="quarto-xref">Table&nbsp;<span>8.2</span></a>.</p>
</section>
<section id="fitting-a-simple-linear-regression-model" class="level2" data-number="8.11">
<h2 data-number="8.11" class="anchored" data-anchor-id="fitting-a-simple-linear-regression-model"><span class="header-section-number">8.11</span> Fitting a simple linear regression model</h2>
<p>To fit a simple linear regression model, choose <strong>Regression &gt; Linear Regression</strong></p>
<p>Select <code>FVC</code> as the <strong>Dependent variable</strong>, and <code>Height</code> as a <strong>Covariate</strong> (Jamovi refers to continuous explanatory variables as <em>covariates</em>). To obtain the 95% confidence interval for the regression coefficients, scroll down to the <strong>Model Coefficients</strong> section and click the <strong>Confidence interval</strong> option for Estimate.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod08/jamovi/regr-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>You will notice that the Jamovi output does not provide the degrees of freedom for the regression coefficient t-statistic. This is equivalent to the degrees of freedom in the preceding correlation matrix: in this case, 118 df.</p>
</section>
<section id="plotting-residuals-from-a-simple-linear-regression" class="level2" data-number="8.12">
<h2 data-number="8.12" class="anchored" data-anchor-id="plotting-residuals-from-a-simple-linear-regression"><span class="header-section-number">8.12</span> Plotting residuals from a simple linear regression</h2>
<p>To plot the residuals, we first need to save them using the <strong>Save</strong> option within the <strong>Linear Regression</strong> command box:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod08/jamovi/resid-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>This creates a new column of <em>Residuals</em> within our dataset:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/mod08/jamovi/resid-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>You can now check the assumption that the residuals are normally distributed by creating a density plot of the residuals using <strong>Exploration &gt; Descriptives</strong>, as shown in <a href="#fig-residual-dist" class="quarto-xref">Figure&nbsp;<span>8.5</span></a>.</p>
<!--  -->
</section>
</section>
<section id="r-notes" class="level1 unnumbered">
<h1 class="unnumbered">R notes</h1>
<p>We will demonstrate using R for correlation and simple linear regression using the dataset <code>mod08_lung_function.csv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>lung <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/examples/mod08_lung_function.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creating-a-scatter-plot-1" class="level2" data-number="8.13">
<h2 data-number="8.13" class="anchored" data-anchor-id="creating-a-scatter-plot-1"><span class="header-section-number">8.13</span> Creating a scatter plot</h2>
<p>We can use the <code>plot</code> function to create a scatter plot to explore the association between height and FVC, assigning meaningful labels with the <code>xlab</code> and <code>ylab</code> commands:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>lung<span class="sc">$</span>Height, <span class="at">y=</span>lung<span class="sc">$</span>FVC, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Height (cm)"</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Forced vital capacity (L)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-correlation-and-regression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To add a fitted line, we can use the <code>abline()</code> function which adds a straight line to the plot. The equation of this straight line will be determined from the estimated regression line, which we specify with the <code>lm()</code> function, which fits a <em>linear model</em>.</p>
<p>The basic syntax of the <code>lm()</code> function is: <code>lm(y ~ x)</code> where <code>y</code> represents the <em>outcome</em> variable, and <code>x</code> represents the <em>explanatory</em> variable. Putting this all together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>lung<span class="sc">$</span>Height, <span class="at">y=</span>lung<span class="sc">$</span>FVC,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Height (cm)"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Forced vital capacity (L)"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(lung<span class="sc">$</span>FVC <span class="sc">~</span> lung<span class="sc">$</span>Height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-correlation-and-regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note: to obtain output similar to Jamovi output, we can use the <code>scatr</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install scatr if required:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.package("scatr")</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatr)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scat</span>(<span class="at">data=</span>lung, <span class="at">x=</span><span class="st">"Height"</span>, <span class="at">y=</span><span class="st">"FVC"</span>, <span class="at">line=</span><span class="st">"linear"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-correlation-and-regression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-a-correlation-coefficient-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="calculating-a-correlation-coefficient-1">Calculating a correlation coefficient</h2>
<p>We can use the <code>corrMatrix</code> function in the Jamovi package to calculate a Pearson’s correlation coefficient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrMatrix</span>(<span class="at">data=</span>lung, <span class="at">vars=</span><span class="fu">c</span>(Height, FVC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 CORRELATION MATRIX

 Correlation Matrix                                   
 ──────────────────────────────────────────────────── 
                            Height        FVC         
 ──────────────────────────────────────────────────── 
   Height    Pearson's r             —                
             df                      —                
             p-value                 —                
                                                      
   FVC       Pearson's r     0.6976279            —   
             df                    118            —   
             p-value        &lt; .0000001            —   
 ──────────────────────────────────────────────────── </code></pre>
</div>
</div>
</section>
<section id="fitting-a-simple-linear-regression-model-1" class="level2" data-number="8.14">
<h2 data-number="8.14" class="anchored" data-anchor-id="fitting-a-simple-linear-regression-model-1"><span class="header-section-number">8.14</span> Fitting a simple linear regression model</h2>
<p>We can use the <code>lm</code> function to fit a simple linear regression model, specifying the model as <code>y ~ x</code> where <code>y</code> represents the <em>outcome</em> variable, and <code>x</code> represents the <em>explanatory</em> variable. Using <code>mod08_lung_function.csv</code>, we can quantify the relationship between FVC and height:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(FVC <span class="sc">~</span> Height, <span class="at">data=</span>lung)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FVC ~ Height, data = lung)

Coefficients:
(Intercept)       Height  
   -18.8735       0.1408  </code></pre>
</div>
</div>
<p>The default output from the <code>lm</code> function is rather sparse. We can obtain much more useful information by defining the linear regression model as an object, then using the <code>summary()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(FVC <span class="sc">~</span> Height, <span class="at">data=</span>lung)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FVC ~ Height, data = lung)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.01139 -0.23643 -0.02082  0.24918  1.31786 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -18.87347    2.19365  -8.604 3.89e-14 ***
Height        0.14076    0.01331  10.577  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3965 on 118 degrees of freedom
Multiple R-squared:  0.4867,    Adjusted R-squared:  0.4823 
F-statistic: 111.9 on 1 and 118 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Finally, we can obtain 95% confidence intervals for the regression coefficients using the <code>confint</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %      97.5 %
(Intercept) -23.2174967 -14.5294441
Height        0.1144042   0.1671092</code></pre>
</div>
</div>
<p>Note that the output for R looks slightly different from the Jamovi output, the numerical values are identical.</p>
</section>
<section id="plotting-residuals-from-a-simple-linear-regression-1" class="level2" data-number="8.15">
<h2 data-number="8.15" class="anchored" data-anchor-id="plotting-residuals-from-a-simple-linear-regression-1"><span class="header-section-number">8.15</span> Plotting residuals from a simple linear regression</h2>
<p>We can use the <code>resid</code> function to obtain the residuals from a saved model. These residuals can then be plotted using a density plot in the usual way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(model)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(residuals))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-correlation-and-regression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="activities" class="level1 unnumbered">
<h1 class="unnumbered">Activities</h1>
<section id="activity-8.1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-8.1">Activity 8.1</h3>
<p>To investigate how body weight (kg) effects blood plasma volume (mL), data were collected from 30 participants and a simple linear regression analysis was conducted. The slope of the regression was 68 (95% confidence interval 52 to 84) and the intercept was −1570 (95% confidence interval −2655 to −492).</p>
<p>[<em>You do not need software for this Activity</em>]</p>
<ol type="a">
<li>What is the outcome variable and explanatory (exposure) variable?</li>
<li>Interpret the regression slope and its 95% CI</li>
<li>Write the regression equation</li>
<li>If we randomly sampled a person from the population and found that their weight is 80kg, what would be the predicted value of plasma volume for this person?</li>
</ol>
</section>
<section id="activity-8.2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-8.2">Activity 8.2</h3>
<p>To examine whether age predicts IQ, data were collected on 104 people. Use the data in the file <code>Activity_8.2.rds</code> to answer the following questions.</p>
<ol type="a">
<li>What is the outcome variable and the explanatory variable?</li>
<li>Create a scatter plot with the two variables. What can you infer from the scatter plot?</li>
<li>Obtain the correlation coefficient between age and IQ and interpret it.</li>
<li>Conduct a simple linear regression and report the relationship between the two variables including the interpretation of the R<sup>2</sup> value. Are the assumptions for linear regression met in this model?</li>
<li>What could you infer about the association between age and IQ in the population, based on the results of the regression analysis in this sample?</li>
</ol>
</section>
<section id="activity-8.3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-8.3">Activity 8.3</h3>
<p>Which of the following correlation coefficients indicates the weakest linear relationship and why?</p>
<ol type="a">
<li>r = 0.72</li>
<li>r = 0.41</li>
<li>r = 0.13</li>
<li>r = −0.33</li>
<li>r = −0.84</li>
</ol>
</section>
<section id="activity-8.4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="activity-8.4">Activity 8.4</h3>
<p>Are the following statements true or false?</p>
<ol type="a">
<li>If a correlation coefficient is closer to 1.00 than to 0.00, this indicates that the outcome is caused by the exposure.</li>
<li>If a researcher has data on two variables, there will be a higher correlation if the two means are close together and a lower correlation if the two means are far apart.</li>
</ol>
</section>
<section id="supplementary-activity-8.5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="supplementary-activity-8.5">Supplementary Activity 8.5</h3>
<p>A cross-sectional study was conducted to examine the association between gestational age and systolic blood pressure in low birthweight babies. Data were collected at birth from 60 low birthweight babies and saved in the file Activity_8.5_babies.csv. The dataset contains the following variables:</p>
<ul>
<li>ID: participant ID number</li>
<li>sbp: systolic blood pressure (mmHg)</li>
<li>gestage: gestational age (weeks)</li>
</ul>
<p>In this analysis, the researchers are interested in assessing the association between systolic blood pressure (the outcome variable) and gestational age (the explanatory variable).</p>
<p>NOTE: there is no need to apply clinical knowledge to the values of systolic blood pressure.</p>
<ol type="a">
<li>Produce a scatter plot summarising the relationship between systolic blood pressure and gestational age, and describe this relationship.</li>
<li>Estimate the correlation coefficient between systolic blood pressure and gestational age, and interpret it.</li>
<li>Fit a simple linear regression model predicting systolic blood pressure from gestational age, and present the estimated regression equation.</li>
<li>Are the assumptions of simple linear regression satisfied for your regression model? Provide evidence to support your claim.</li>
<li>Summarise your regression model in a brief conclusion.</li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bland15" class="csl-entry" role="listitem">
Bland, Martin. 2015. <em>An <span>Introduction</span> to <span>Medical Statistics</span></em>. 4th Edition. Oxford, New York: Oxford University Press.
</div>
<div id="ref-kirkwood_sterne01" class="csl-entry" role="listitem">
Kirkwood, Betty, and Jonathan Sterne. 2001. <em>Essentials of <span>Medical Statistics</span></em>. 2nd edition. Malden, Mass: Wiley-Blackwell.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-testing-proportions.html" class="pagination-link" aria-label="Hypothesis testing for categorical data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis testing for categorical data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-non-parametrics.html" class="pagination-link" aria-label="Analysing non-normal data">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysing non-normal data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>